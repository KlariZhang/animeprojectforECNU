# B站爬虫工具集

这个Python脚本整合了三个针对Bilibili平台的数据爬取功能，可以帮助用户获取B站排行榜、番剧评论以及动漫二创视频数据。

## 功能概述

### 1. B站排行榜抓取
- **功能**：获取指定分区的视频排行榜数据
- **输入**：分区ID（如168代表国创分区）
- **输出**：包含视频排名、标题、播放量、点赞数等详细信息的CSV文件
- **示例命令**：
  ```python
  python bilibili_scraper_final_full.py
  输入选项: 1
  输入分区rid: 168
  ```

### 2. 番剧评论抓取
- **功能**：获取指定番剧所有剧集的评论
- **输入**：番剧名称
- **输出**：包含所有剧集评论的JSON文件
- **示例命令**：
  ```python
  python bilibili_scraper_final_full.py
  输入选项: 2
  输入番剧名称: 鬼灭之刃
  ```

### 3. 动漫二创视频抓取
- **功能**：根据动漫列表抓取相关的二创视频
- **输入**：
  - 包含动漫名称的CSV文件路径
  - 输出结果CSV文件路径
- **输出**：包含二创视频信息的CSV文件
- **示例命令**：
  ```python
  python bilibili_scraper_final_full.py
  输入选项: 3
  输入CSV路径: anime_list.csv
  输出结果路径: fanmade_results.csv
  ```

## 环境配置

1. 安装依赖：
   ```bash
   pip install requests pandas tqdm python-dotenv
   ```

2. 创建`.env`文件并添加B站Cookie：
   ```
   BILIBILI_COOKIE=your_bilibili_cookie_here
   ```

## 二创视频爬取实现思路

### 核心流程

1. **关键词扩展**：
   - 通过Bangumi API获取动漫的别名、角色名等扩展关键词
   - 过滤无效角色（如"路人"、"群演"等）
   - 示例：输入"鬼灭之刃" → 扩展出"灶门炭治郎"、"祢豆子"等关键词

2. **B站视频搜索**：
   - 使用扩展关键词在B站搜索视频
   - 自动添加二创相关后缀（"MAD"、"混剪"等）
   - 每个关键词搜索3页结果

3. **二创视频筛选**：
   ```python
   if (包含扩展关键词 and 
       包含二创标签 and 
       包含主名称 and 
       非官方标签 and 
       非官方作者):
       收集视频信息
   ```

4. **数据收集**：
   - 视频标题、播放量、收藏数等核心指标
   - UP主信息、视频链接、标签等详细信息

### 关键技术点

- **闲角过滤**：使用`EXCLUDE_ROLE_KEYWORDS`列表过滤无效角色
- **官方内容识别**：
  - 作者名包含"官方"、"出品"等关键词
  - 标签包含"PV"、"预告"等官方标识
- **多维度匹配**：同时检查标题、标签、作者等多个字段
- **抗反爬措施**：
  - 请求间隔0.5秒
  - 使用合法Cookie
  - 随机User-Agent

## 使用建议

1. **输入文件格式**：
   ```csv
   anime
   鬼灭之刃
   咒术回战
   间谍过家家
   ```

2. **最佳实践**：
   - 在网络稳定时段运行
   - 每次运行不超过10部动漫
   - 定期更新B站Cookie

3. **结果分析**：
   - 通过播放量/收藏比评估视频质量
   - 分析高频标签发现热门二创类型
   - 追踪头部UP主获取优质内容源
